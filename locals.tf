# ==============================================================================
# LOCALS - Configuraรงรฃo Centralizada
# ==============================================================================
# 
# โ๏ธ PONTO รNICO DE CONFIGURAรรO
# Altere apenas o 'aws_account_suffix' e ele serรก propagado para:
#   - Nomes de recursos S3/DynamoDB
#   - Tags de recursos
#   - Outputs
#
# โ๏ธ IMPORTANTE: O backend S3 no main.tf ainda precisa ser atualizado manualmente
#    apรณs mudar o aws_account_suffix (limitaรงรฃo do Terraform)
#
# ==============================================================================

locals {
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  # โ โ๏ธ CONFIGURAรรO PRINCIPAL - ALTERE AQUI                             โ
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  aws_account_id     = "533267363894"
  aws_account_suffix = "533267363894-10"  # ๐ฏ MUDE APENAS ESTE VALOR
  aws_region         = "us-east-1"
  
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  # โ ๐ฆ NOMES DE RECURSOS (gerados automaticamente)                      โ
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  s3_bucket_name      = "tech-challenge-tfstate-${local.aws_account_suffix}"
  dynamodb_table_name = "tech-challenge-terraform-lock-${local.aws_account_suffix}"
  
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  # โ ๐ IAM Configuration                                                โ
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  lab_role_arn = "arn:aws:iam::${local.aws_account_id}:role/LabRole"
  
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  # โ ๐ท๏ธ TAGS PADRรO (aplicadas a todos os recursos)                      โ
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  common_tags = {
    AccountId     = local.aws_account_id
    AccountSuffix = local.aws_account_suffix
    Region        = local.aws_region
    Lab           = "aws-learner-lab"
    Owner         = var.owner
    Environment   = var.environment
    Project       = var.project_name
    ManagedBy     = "terraform"
  }
  
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  # โ โ VALIDAรรO DE CONTA                                               โ
  # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  is_correct_account = data.aws_caller_identity.current.account_id == local.aws_account_id
}